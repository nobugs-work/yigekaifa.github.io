<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>一个开发</title>
  
  <subtitle>不够精彩的生活和工作也需要记录一下</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://yigekaifa.com/"/>
  <updated>2020-03-10T22:37:51.178Z</updated>
  <id>https://yigekaifa.com/</id>
  
  <author>
    <name>一个开发</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>如果我死了</title>
    <link href="https://yigekaifa.com/if-i-dead/"/>
    <id>https://yigekaifa.com/if-i-dead/</id>
    <published>2020-03-10T22:22:26.000Z</published>
    <updated>2020-03-10T22:37:51.178Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://jpzhpg.bn.files.1drv.com/y4miTx58UjP8TG9PXij2Yu8FXjZXCOCNoiZZjznwDhBhkU5_-W8URzg-veXS6iy8IxttQgD2kLWkFJHwxEfZ-pYk3jKoY8WKUB6qdT1WdNhEq08Sf9qXNxm3-fPOF9ltC23w2qa02yRbqWJ0FPqsfjYPruDQj7JeItmRp2zCVw8NSh0l_vNEarhTBUGgYqMMgFNFhqwbxMXxXOLkHHaFwj0ew?width=4000&height=3000&cropmode=none" alt="我的阳台外"></p><blockquote><p>2020年3月11日 早 6：00</p></blockquote><p>昨晚没睡，但这不重要。问题是我丝毫没有瞌睡的感觉，而且我昨天没喝咖啡。</p><p>所以啊，如果有一天我猝死了，我不希望有新闻带上我的职业。就写一男子猝死就行了。</p><p>另外是不是人死之前都会写一些奇怪的东西…这些都不知道为什么想出来的，我现在也不想写奇怪的东西。我想写一下简历，然后收拾一下垃圾。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://jpzhpg.bn.files.1drv.com/y4miTx58UjP8TG9PXij2Yu8FXjZXCOCNoiZZjznwDhBhkU5_-W8URzg-veXS6iy8IxttQgD2kLWkFJHwxEfZ-pYk3jKoY8
      
    
    </summary>
    
    
      <category term="Think" scheme="https://yigekaifa.com/categories/Think/"/>
    
    
      <category term="熬夜" scheme="https://yigekaifa.com/tags/%E7%86%AC%E5%A4%9C/"/>
    
      <category term="随想" scheme="https://yigekaifa.com/tags/%E9%9A%8F%E6%83%B3/"/>
    
      <category term="照片" scheme="https://yigekaifa.com/tags/%E7%85%A7%E7%89%87/"/>
    
  </entry>
  
  <entry>
    <title>PowerShell禁止执行脚本的解决方法</title>
    <link href="https://yigekaifa.com/script-cant-run-on-powershell/"/>
    <id>https://yigekaifa.com/script-cant-run-on-powershell/</id>
    <published>2020-03-10T18:26:23.000Z</published>
    <updated>2020-03-10T19:34:14.407Z</updated>
    
    <content type="html"><![CDATA[<p>如果出现类似下面的提示：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">无法加载文件 ******.xxx，因为在此系统中禁止执行脚本。有关详细信息，请参阅 <span class="string">"get-help about_signing"</span>。</span><br><span class="line">所在位置 行:1 字符: 17</span><br></pre></td></tr></table></figure><p>解决方法：</p><a id="more"></a><p>运行<code>Get-ExecutionPolicy</code>。如果返回<code>Restricted</code>，然后运行<code>set-ExecutionPolicy RemoteSigned</code></p><p>然后就可以运行命令了。</p><p>另外如果还不能执行，例如你npm安装的一些命令不能运行，那么请你把<code>C:\Users\用户名\AppData\Roaming\npm</code>添加到系统变量<code>Path</code>里面。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;如果出现类似下面的提示：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;无法加载文件 ******.xxx，因为在此系统中禁止执行脚本。有关详细信息，请参阅 &lt;span class=&quot;string&quot;&gt;&quot;get-help about_signing&quot;&lt;/span&gt;。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;所在位置 行:1 字符: 17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;解决方法：&lt;/p&gt;
    
    </summary>
    
    
      <category term="Note" scheme="https://yigekaifa.com/categories/Note/"/>
    
    
      <category term="PowerShell" scheme="https://yigekaifa.com/tags/PowerShell/"/>
    
      <category term="Script" scheme="https://yigekaifa.com/tags/Script/"/>
    
  </entry>
  
  <entry>
    <title>Linux下DD命令进度查看</title>
    <link href="https://yigekaifa.com/dd-cmd-on-linux/"/>
    <id>https://yigekaifa.com/dd-cmd-on-linux/</id>
    <published>2020-03-10T18:25:06.000Z</published>
    <updated>2020-03-10T19:34:02.935Z</updated>
    
    <content type="html"><![CDATA[<p>在Ubuntu 系统上执行如下命令</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">dd if=/img.iso of=/dev/mydevice bs=10M count=100000</span><br></pre></td></tr></table></figure><a id="more"></a><p>有的时候，可能会非常耗时，这个时候，如果让dd命令输出执行进度信息，会非常有用。</p><p>重新打开一个Shell，然后执行如下命令即可每秒输出一次进度信息</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">watch -n 1 pkill -USR1 -x dd</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在Ubuntu 系统上执行如下命令&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;dd if=/img.iso of=/dev/mydevice bs=10M count=100000&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Note" scheme="https://yigekaifa.com/categories/Note/"/>
    
    
      <category term="Linux" scheme="https://yigekaifa.com/tags/Linux/"/>
    
      <category term="cmd" scheme="https://yigekaifa.com/tags/cmd/"/>
    
  </entry>
  
  <entry>
    <title>自带清除内容功能的EditText</title>
    <link href="https://yigekaifa.com/edittext-with-clear-icon/"/>
    <id>https://yigekaifa.com/edittext-with-clear-icon/</id>
    <published>2020-03-10T18:23:58.000Z</published>
    <updated>2020-03-10T21:55:01.723Z</updated>
    
    <content type="html"><![CDATA[<p>出发需求：</p><ol><li>减少手写清除EditText内容的代码</li><li>xml里面写的话，点击清除按钮会失去焦点，然后软键盘消失，需要重复点击输入框才可以继续输入</li></ol><a id="more"></a><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClearEditText</span> <span class="keyword">extends</span> <span class="title">AppCompatEditText</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnFocusChangeListener</span>, <span class="title">View</span>.<span class="title">OnTouchListener</span>, <span class="title">TextWatcher</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Drawable mClearTextIcon;</span><br><span class="line">    <span class="keyword">private</span> OnFocusChangeListener mOnFocusChangeListener;</span><br><span class="line">    <span class="keyword">private</span> OnTouchListener mOnTouchListener;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isShowClearIcon;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClearEditText</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">        init(context, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClearEditText</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">        init(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ClearEditText</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">        init(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        mClearTextIcon = getCompoundDrawables()[<span class="number">2</span>];</span><br><span class="line">        TypedArray typedArray = context.obtainStyledAttributes(attrs, R.styleable.ClearEditText);</span><br><span class="line">        isShowClearIcon = typedArray.getBoolean(R.styleable.ClearEditText_isShowClearIcon, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">if</span> (mClearTextIcon == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">final</span> Drawable drawable = ContextCompat.getDrawable(context, R.mipmap.icon_clear_text);</span><br><span class="line">            <span class="keyword">final</span> Drawable wrapDrawable = DrawableCompat.wrap(drawable);</span><br><span class="line">            DrawableCompat.setTint(wrapDrawable, getCurrentHintTextColor());</span><br><span class="line">            mClearTextIcon = wrapDrawable;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mClearTextIcon.setBounds(<span class="number">0</span>, <span class="number">0</span>, mClearTextIcon.getIntrinsicHeight(), mClearTextIcon.getIntrinsicHeight());</span><br><span class="line">        setClearIconVisible(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">super</span>.setOnFocusChangeListener(<span class="keyword">this</span>);</span><br><span class="line">        <span class="keyword">super</span>.setOnTouchListener(<span class="keyword">this</span>);</span><br><span class="line">        addTextChangedListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setmOnFocusChangeListener</span><span class="params">(OnFocusChangeListener mOnFocusChangeListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mOnFocusChangeListener = mOnFocusChangeListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setmOnTouchListener</span><span class="params">(OnTouchListener mOnTouchListener)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.mOnTouchListener = mOnTouchListener;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setClearIconVisible</span><span class="params">(<span class="keyword">boolean</span> visible)</span> </span>&#123;</span><br><span class="line">        mClearTextIcon.setVisible(visible &amp;&amp; isShowClearIcon, <span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">final</span> Drawable[] compoundDrawables = getCompoundDrawables();</span><br><span class="line">        setCompoundDrawables(</span><br><span class="line">                compoundDrawables[<span class="number">0</span>],</span><br><span class="line">                compoundDrawables[<span class="number">1</span>],</span><br><span class="line">                visible ? mClearTextIcon : <span class="keyword">null</span>,</span><br><span class="line">                compoundDrawables[<span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFocusChange</span><span class="params">(View v, <span class="keyword">boolean</span> hasFocus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (hasFocus) &#123;</span><br><span class="line">            setClearIconVisible(getText().length() &gt; <span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            setClearIconVisible(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mOnFocusChangeListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">            mOnFocusChangeListener.onFocusChange(v, hasFocus);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent motionEvent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = (<span class="keyword">int</span>) motionEvent.getX();</span><br><span class="line">        <span class="keyword">if</span> (mClearTextIcon.isVisible() &amp;&amp; x &gt; getWidth() - getPaddingRight() - mClearTextIcon.getIntrinsicWidth()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (motionEvent.getAction() == motionEvent.ACTION_UP) &#123;</span><br><span class="line">                setError(<span class="keyword">null</span>);</span><br><span class="line">                setText(<span class="string">""</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (mOnTouchListener != <span class="keyword">null</span> &amp;&amp; mOnTouchListener.onTouch(v, motionEvent));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">isShowClearIcon</span><span class="params">(<span class="keyword">boolean</span> isShowClearIcon)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.isShowClearIcon = isShowClearIcon;</span><br><span class="line">        setClearIconVisible(getText().length() &gt; <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTextChanged</span><span class="params">(CharSequence text, <span class="keyword">int</span> start, <span class="keyword">int</span> lengthBefore, <span class="keyword">int</span> lengthAfter)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isFocused()) &#123;</span><br><span class="line">            setClearIconVisible(text.length() &gt; <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">beforeTextChanged</span><span class="params">(CharSequence s, <span class="keyword">int</span> start, <span class="keyword">int</span> count, <span class="keyword">int</span> after)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterTextChanged</span><span class="params">(Editable s)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>attrs：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">declare-styleable</span> <span class="attr">name</span>=<span class="string">"ClearEditText"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--是否需要展示清除按钮--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">attr</span> <span class="attr">name</span>=<span class="string">"isShowClearIcon"</span> <span class="attr">format</span>=<span class="string">"boolean"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">declare-styleable</span>&gt;</span></span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">xxx.ClearEditText</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--some parms here--&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--set is show the icon here--&gt;</span></span><br><span class="line">    app:isShowClearIcon = "true"</span><br><span class="line"><span class="tag">&lt;/<span class="name">ClearEditText</span>&gt;</span></span><br></pre></td></tr></table></figure><p>或者在<code>java</code>代码中:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">clearTextView.isShowClearIcon(<span class="keyword">true</span>);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;出发需求：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;减少手写清除EditText内容的代码&lt;/li&gt;
&lt;li&gt;xml里面写的话，点击清除按钮会失去焦点，然后软键盘消失，需要重复点击输入框才可以继续输入&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="Dev" scheme="https://yigekaifa.com/categories/Dev/"/>
    
    
      <category term="Edittext" scheme="https://yigekaifa.com/tags/Edittext/"/>
    
      <category term="Custom" scheme="https://yigekaifa.com/tags/Custom/"/>
    
  </entry>
  
  <entry>
    <title>监听布局内所有的EditText</title>
    <link href="https://yigekaifa.com/listen-all-edittext-in-your-layout/"/>
    <id>https://yigekaifa.com/listen-all-edittext-in-your-layout/</id>
    <published>2020-03-10T15:49:23.000Z</published>
    <updated>2020-03-10T18:15:58.298Z</updated>
    
    <content type="html"><![CDATA[<p>当出现布局内有N个输入框且需要同步监听，例如你需要监听用户输入所有内容之后才可以点击下一步的控件，你可以试试下面这个控件。</p><a id="more"></a><h2 id="1-获取子view"><a href="/listen-all-edittext-in-your-layout/#1-获取子view" class="headerlink" title="1. 获取子view"></a>1. 获取子view</h2><p>编历布局，看当前布局有几个<code>EditText</code>,然后去监听拿到<code>focus</code>的<code>view</code></p><p>获取子<code>view</code>的方式：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 遍历viewGroup</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">traverseViewGroup</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> viewCount = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == view) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (view <span class="keyword">instanceof</span> ViewGroup) &#123;</span><br><span class="line">            <span class="comment">//遍历ViewGroup,是子view加1，是ViewGroup递归调用</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; ((ViewGroup) view).getChildCount(); i++) &#123;</span><br><span class="line">                View child = ((ViewGroup) view).getChildAt(i);</span><br><span class="line">                <span class="keyword">if</span> (child <span class="keyword">instanceof</span> ViewGroup) &#123;</span><br><span class="line">                    viewCount += traverseViewGroup(((ViewGroup) view).getChildAt(i));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    viewCount++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            viewCount++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> viewCount;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>非递归方法获取子<code>view</code>：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 遍历viewGroup</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">traverseViewGroup</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> viewCount = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">null</span> == view) &#123;</span><br><span class="line">           <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">if</span> (view <span class="keyword">instanceof</span> ViewGroup) &#123;</span><br><span class="line">           ViewGroup viewGroup = (ViewGroup) view;</span><br><span class="line">           LinkedList&lt;ViewGroup&gt; linkedList = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">           linkedList.add(viewGroup);</span><br><span class="line">           <span class="keyword">while</span> (!linkedList.isEmpty()) &#123;</span><br><span class="line">               <span class="comment">//removeFirst()删除第一个元素，并返回该元素</span></span><br><span class="line">               ViewGroup current = linkedList.removeFirst();</span><br><span class="line">               viewCount++;</span><br><span class="line">               <span class="comment">//遍历linkedList中第一个viewGroup中的子view</span></span><br><span class="line">               <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; current.getChildCount(); i++) &#123;</span><br><span class="line">                   <span class="keyword">if</span> (current.getChildAt(i) <span class="keyword">instanceof</span> ViewGroup) &#123;</span><br><span class="line">                       linkedList.addLast((ViewGroup) current.getChildAt(i));</span><br><span class="line">                   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                       viewCount++;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           viewCount++;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> viewCount;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>获取到子<code>view</code>的时候，你需要判断这个子<code>view</code>是不是<code>EditText</code>，方法有两种：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">v.getClassName() == <span class="string">"EditText"</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">v <span class="keyword">instanceof</span> Button</span><br></pre></td></tr></table></figure><h2 id="2-拿到子view之后："><a href="/listen-all-edittext-in-your-layout/#2-拿到子view之后：" class="headerlink" title="2. 拿到子view之后："></a>2. 拿到子view之后：</h2><p>方法1. 拿到子<code>view</code>之后，不需要每个都去监听（当然你也可以这么做），另外一种，判断在<code>viewgroup</code>中哪个子<code>view</code>获取到了焦点，然后给他添加监听，其他的移除监听。</p><p>然后给设置的按钮去设置<code>enable</code></p><p>方法2. LiveData监听数据变化，但是和上面的方式换汤不换药，代码量更多了一点。LiveData的具体使用可以参考： <a href="https://developer.android.google.cn/reference/android/arch/lifecycle/LiveData" target="_blank" rel="noopener">https://developer.android.google.cn/reference/android/arch/lifecycle/LiveData</a></p><h3 id="需要完成的内容："><a href="/listen-all-edittext-in-your-layout/#需要完成的内容：" class="headerlink" title="需要完成的内容："></a>需要完成的内容：</h3><ul><li><input checked="" disabled="" type="checkbox"> 添加例外的参数，例如非必填的Edittext</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;当出现布局内有N个输入框且需要同步监听，例如你需要监听用户输入所有内容之后才可以点击下一步的控件，你可以试试下面这个控件。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Dev" scheme="https://yigekaifa.com/categories/Dev/"/>
    
    
      <category term="Edittext" scheme="https://yigekaifa.com/tags/Edittext/"/>
    
      <category term="ViewGroup" scheme="https://yigekaifa.com/tags/ViewGroup/"/>
    
      <category term="CustomView" scheme="https://yigekaifa.com/tags/CustomView/"/>
    
  </entry>
  
  <entry>
    <title>startWithPop()出现两个Fragment都退出的情况</title>
    <link href="https://yigekaifa.com/startwithpop-close-both-fragment/"/>
    <id>https://yigekaifa.com/startwithpop-close-both-fragment/</id>
    <published>2020-03-10T15:37:18.000Z</published>
    <updated>2020-03-10T19:34:18.671Z</updated>
    
    <content type="html"><![CDATA[<p>有时候<code>startWithPop()</code>会出现两个<code>Fragment</code>都出栈的情况，一般当前<code>fragment</code>是RootView的时候会出现这个情况。</p><a id="more"></a><p>解决方法：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">((BaseFragment) getParentFragment()).start(toFragment);</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">popTo(A<span class="class">.<span class="keyword">class</span>,<span class="title">true</span>,<span class="title">new</span> <span class="title">Runnable</span>()</span>&#123;</span><br><span class="line">       <span class="meta">@Override</span></span><br><span class="line">       <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            start(B);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;,getFragmentAnimator().getPopExit()); <span class="comment">// getFragmentAnimator().getPopExit() 代表popTo时的动画</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有时候&lt;code&gt;startWithPop()&lt;/code&gt;会出现两个&lt;code&gt;Fragment&lt;/code&gt;都出栈的情况，一般当前&lt;code&gt;fragment&lt;/code&gt;是RootView的时候会出现这个情况。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Dev" scheme="https://yigekaifa.com/categories/Dev/"/>
    
    
      <category term="startWithPop" scheme="https://yigekaifa.com/tags/startWithPop/"/>
    
      <category term="Fragment" scheme="https://yigekaifa.com/tags/Fragment/"/>
    
  </entry>
  
  <entry>
    <title>TabLayout的简单修改</title>
    <link href="https://yigekaifa.com/some-changes-for-tablayout/"/>
    <id>https://yigekaifa.com/some-changes-for-tablayout/</id>
    <published>2020-03-10T15:11:19.000Z</published>
    <updated>2020-03-10T15:13:14.895Z</updated>
    
    <content type="html"><![CDATA[<p>设计稿上的tab布局我用了design库的tablayout，根据设计上的图来看，选中的tab要是粗体，下方横线等宽于字体。</p><a id="more"></a><h3 id="问题1：TabLayout无法控制当前选中的行的字体"><a href="/some-changes-for-tablayout/#问题1：TabLayout无法控制当前选中的行的字体" class="headerlink" title="问题1：TabLayout无法控制当前选中的行的字体"></a>问题1：TabLayout无法控制当前选中的行的字体</h3><p>解决方案：<code>setCustomView()</code> 。</p><p>首先写一个方法，用来返回每个tab的view：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> View <span class="title">getTabView</span><span class="params">(<span class="keyword">int</span> position, String title)</span> </span>&#123;</span><br><span class="line">    View view = LayoutInflater.from(getContext()).inflate(R.layout.tab_item, <span class="keyword">null</span>);</span><br><span class="line">    TextView txt_title = (TextView) view.findViewById(R.id.textView);</span><br><span class="line">    txt_title.setText(title);</span><br><span class="line">    <span class="keyword">return</span> view;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后把view设置到tablayout中：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">tabLayout.getTabAt(<span class="number">0</span>).setCustomView(getTabView(<span class="number">0</span>, <span class="string">"全部"</span>));</span><br></pre></td></tr></table></figure><p>然后去选择控制tablayout的标签的样式，我是新建了一个OnTabSelectedListener，然后再里面进行设置的</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">OnTabSelectedListener onTabSelectedListener = <span class="keyword">new</span> TabLayout.OnTabSelectedListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabSelected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// 选中的tab设置为粗体</span></span><br><span class="line">                TextView textView = tabLayout.getTabAt(tab.getPosition()).getCustomView().findViewById(R.id.textView);</span><br><span class="line">                textView.setTypeface(<span class="keyword">null</span>, Typeface.BOLD);</span><br><span class="line">                viewPager.setCurrentItem(tab.getPosition());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabUnselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line">                <span class="comment">// 未选中的tab设置为正常</span></span><br><span class="line">                TextView textView = tabLayout.getTabAt(tab.getPosition()).getCustomView().findViewById(R.id.textView);</span><br><span class="line">                textView.setTypeface(<span class="keyword">null</span>, Typeface.NORMAL);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTabReselected</span><span class="params">(TabLayout.Tab tab)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br></pre></td></tr></table></figure><p>但是，设置好之后出现了新的问题：</p><h3 id="问题2：下面Indicator宽度始终为最宽的宽度"><a href="/some-changes-for-tablayout/#问题2：下面Indicator宽度始终为最宽的宽度" class="headerlink" title="问题2：下面Indicator宽度始终为最宽的宽度"></a>问题2：下面<code>Indicator</code>宽度始终为最宽的宽度</h3><p>即使你设置了<code>app:tabIndicatorFullWidth=&quot;true&quot;</code>，因为<code>tabIndicatorFullWidth</code>是根据默认布局的文字宽度来设置的，我们自定义布局之后，系统无法获取到文字大小和长度，所以就会设置成最宽的宽度。</p><p>我的解决方法：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reflex</span><span class="params">(<span class="keyword">final</span> TabLayout tabLayout)</span> </span>&#123;</span><br><span class="line">        tabLayout.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    LinearLayout mTabStrip = (LinearLayout) tabLayout.getChildAt(<span class="number">0</span>);</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mTabStrip.getChildCount(); i++) &#123;</span><br><span class="line">                        View tabView = mTabStrip.getChildAt(i);</span><br><span class="line"></span><br><span class="line">                        Field mTextViewField = tabView.getClass().getDeclaredField(<span class="string">"textView"</span>);</span><br><span class="line">                        mTextViewField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">                        TextView mTextView = (TextView) mTextViewField.get(tabView);</span><br><span class="line"></span><br><span class="line">                        tabView.setPadding(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">int</span> width = <span class="number">0</span>;</span><br><span class="line">                        width = mTextView.getWidth();</span><br><span class="line">                        <span class="keyword">if</span> (width == <span class="number">0</span>) &#123;</span><br><span class="line">                            mTextView.measure(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                            width = mTextView.getMeasuredWidth();</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        LinearLayout.LayoutParams params = (LinearLayout.LayoutParams) tabView.getLayoutParams();</span><br><span class="line">                        params.width = width;</span><br><span class="line"></span><br><span class="line">                        WindowManager wm1 = ((Activity) getContext()).getWindowManager();</span><br><span class="line">                        <span class="keyword">int</span> width1 = wm1.getDefaultDisplay().getWidth();</span><br><span class="line">                        LogUtils.d(<span class="string">""</span> + width1 / tabLayout.getTabCount() + <span class="string">"============="</span> + mTextView.getText().length() * dip2px(tabLayout.getContext(), <span class="number">15</span>));</span><br><span class="line"></span><br><span class="line">                        params.leftMargin = (width1 / tabLayout.getTabCount() - mTextView.getText().length() * dip2px(tabLayout.getContext(), <span class="number">15</span>)) / <span class="number">2</span>;</span><br><span class="line">                        params.rightMargin = (width1 / tabLayout.getTabCount() - mTextView.getText().length() * dip2px(tabLayout.getContext(), <span class="number">15</span>)) / <span class="number">2</span>;</span><br><span class="line">                        tabView.setLayoutParams(params);</span><br><span class="line"></span><br><span class="line">                        tabView.invalidate();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">dip2px</span><span class="params">(Context context, <span class="keyword">float</span> dpValue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">float</span> scale = context.getResources().getDisplayMetrics().density;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>) (dpValue * scale + <span class="number">0.5f</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>reflex(tabLayout);</code>调用在所有<code>getTabAt</code>方法之后即可解决这个，但是还有点小问题，tab大小被设置成了文字宽度…这个问题暂时保留，下次解决。另外有几个小问题</p><ol><li>去掉tab的水波纹效果，无论是support还是AdnroidX，都用<code>app:tabRippleColor=&quot;@android:color/transparent&quot;</code>，<code>app:tabBackground=&quot;@android:color/transparent&quot;</code>即使在support下也无效</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;设计稿上的tab布局我用了design库的tablayout，根据设计上的图来看，选中的tab要是粗体，下方横线等宽于字体。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Dev" scheme="https://yigekaifa.com/categories/Dev/"/>
    
    
      <category term="TabLayout" scheme="https://yigekaifa.com/tags/TabLayout/"/>
    
      <category term="widget" scheme="https://yigekaifa.com/tags/widget/"/>
    
      <category term="custom" scheme="https://yigekaifa.com/tags/custom/"/>
    
  </entry>
  
  <entry>
    <title>Android中几种定位方式的粗解</title>
    <link href="https://yigekaifa.com/some-way-to-get-location/"/>
    <id>https://yigekaifa.com/some-way-to-get-location/</id>
    <published>2020-03-10T14:46:16.000Z</published>
    <updated>2020-03-11T00:21:48.471Z</updated>
    
    <content type="html"><![CDATA[<p>之前朋友问我Tiktok为什么禁用了定位，开启了全局代理，还是可以获取到位置。当时想法只有一个：基站定位。我让他在设置里关掉移动服务（关闭手机卡）之后，确实可以正常使用了。</p><p>这里简单说一下Android中集中定位方式。</p><a id="more"></a><blockquote><p>这里是在Android10添加的新权限，在后台获取位置：<a href="https://developer.android.com/reference/android/Manifest.permission.html#ACCESS_BACKGROUND_LOCATION" target="_blank" rel="noopener">https://developer.android.com/reference/android/Manifest.permission.html#ACCESS_BACKGROUND_LOCATION</a></p></blockquote><h2 id="1-GPS"><a href="/some-way-to-get-location/#1-GPS" class="headerlink" title="1. GPS"></a>1. GPS</h2><p>权限（注意版本变化）：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_FINE_LOCATION"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_COARSE_LOCATION"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>具体定位代码</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> locManager = getSystemService(Context.LOCATION_SERVICE) as LocationManager</span><br><span class="line"><span class="keyword">var</span> loc = locManager.getLastKnownLocation(LocationManager.GPS_PROVIDER)</span><br><span class="line"><span class="keyword">if</span>(loc != <span class="keyword">null</span>)&#123;</span><br><span class="line">    Log.e(<span class="string">"gpslocation"</span>, loc.toString())</span><br><span class="line">    toast(loc.toString())</span><br><span class="line">&#125;</span><br><span class="line">locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, <span class="number">0</span>, <span class="number">0F</span>, object : LocationListener&#123;</span><br><span class="line">    <span class="function">override fun <span class="title">onStatusChanged</span><span class="params">(provider: String?, status: Int, extras: Bundle?)</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">override fun <span class="title">onProviderEnabled</span><span class="params">(provider: String?)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">override fun <span class="title">onProviderDisabled</span><span class="params">(provider: String?)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">override fun <span class="title">onLocationChanged</span><span class="params">(location: Location?)</span> </span>&#123;</span><br><span class="line">        Log.e(<span class="string">"gpslocation"</span>, location.toString())</span><br><span class="line">        toast(location.toString())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="2-Network获取位置"><a href="/some-way-to-get-location/#2-Network获取位置" class="headerlink" title="2. Network获取位置"></a>2. Network获取位置</h3><p>与GPS定位相同，代码都一样。只是申请权限不同。并且在室内时，GPS需要一定时间来定位，而Network在网络状况不好时不可用。</p><h3 id="3-IP"><a href="/some-way-to-get-location/#3-IP" class="headerlink" title="3. IP"></a>3. IP</h3><p>APP通过对当前IP的分析，可以得到你大致的位置。一般不采用这种方案，IP太容易被伪装。</p><h3 id="4-WiFi（WLAN）定位"><a href="/some-way-to-get-location/#4-WiFi（WLAN）定位" class="headerlink" title="4. WiFi（WLAN）定位"></a>4. WiFi（WLAN）定位</h3><p>需要权限：</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_WIFI_STATE"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>这个也比较简单，就是过程就是拿到当前的WiFi信息，然后通过mac地址（BSSID）进行查询。具体查询的接口可以去聚合数据搜索一下，这里不再多说。</p><h3 id="5-基站定位"><a href="/some-way-to-get-location/#5-基站定位" class="headerlink" title="5. 基站定位"></a>5. 基站定位</h3><p>这个要稍微说一下。在你关闭了所有定位传感器之后，如果你的手机还是处于有服务的状态下，就可以进行大概定位。通过TelephonyManager获取当前手机信号的基站信息。可以定位到大概区以下的位置。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MCC，Mobile Country Code，移动国家代码（中国的为460）</span><br><span class="line">MNC，Mobile Network Code，移动网络号码（中国移动为00，中国联通为01）</span><br><span class="line">LAC，Location Area Code，位置区域码</span><br><span class="line">CID，Cell Identity，基站编号，是个16位的数据（范围是0到65535）</span><br></pre></td></tr></table></figure><p>看似类型繁多，但是实际用起来用处不是很多。建议大家还是用第三方定位库吧，简单精准还好用。</p><p>参考文章</p><blockquote><p><a href="https://developer.android.com/guide/topics/location/strategies" target="_blank" rel="noopener">https://developer.android.com/guide/topics/location/strategies</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;之前朋友问我Tiktok为什么禁用了定位，开启了全局代理，还是可以获取到位置。当时想法只有一个：基站定位。我让他在设置里关掉移动服务（关闭手机卡）之后，确实可以正常使用了。&lt;/p&gt;
&lt;p&gt;这里简单说一下Android中集中定位方式。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Dev" scheme="https://yigekaifa.com/categories/Dev/"/>
    
    
      <category term="Android" scheme="https://yigekaifa.com/tags/Android/"/>
    
      <category term="Location" scheme="https://yigekaifa.com/tags/Location/"/>
    
      <category term="定位" scheme="https://yigekaifa.com/tags/%E5%AE%9A%E4%BD%8D/"/>
    
  </entry>
  
</feed>
